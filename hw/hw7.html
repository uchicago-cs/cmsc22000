
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Homework 7: Deployment &#8212; CMSC 22000 - Introduction to Software Development</title>

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/chiweb.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Homework 7 Rubric" href="hw7_rubric.html" />
    <link rel="prev" title="Homework 6 Rubric" href="hw6_rubric.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          CMSC 22000 - Introduction to Software Development</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              
              
            
            
            
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Course Information <span class="caret"></span></a>
    <ul class="dropdown-menu">
        <li><a href="../syllabus.html">Syllabus</a></li>
        <li><a href="../calendar.html">Calendar</a></li>
        <li><a href="../code-of-conduct.html">Code of Conduct for Course Staff</a></li>
    </ul>
</li>
<li><a href="index.html">Homework</a></li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Project <span class="caret"></span></a>
    <ul class="dropdown-menu">
        <li><a href="../project/index.html">Introduction</a></li>
        <li><a href="../project/chiventure.html">chiventure</a></li>
        <li><a href="../project/policies.html">Policies</a></li>
        <li><a href="../project/issue-pr-grading.html">Issue/PR Grading</a></li>
        <li><a href="../project/features.html">Features</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Resources <span class="caret"></span></a>
    <ul class="dropdown-menu">
        <li><a href="../resources/faq.html">CS 220 FAQs</a></li>
        <li><a href="../resources/tutorials/index.html">Tutorials</a></li>
        <li><a href="https://uchicago-cs.github.io/dev-guide/" target="_blank">UChicago CS Developer's Guide <i class="fa fa-external-link"></i></a></li>
        <li><a href="https://uchicago-cs.github.io/debugging-guide" target="_blank">The Debugging Guide <i class="fa fa-external-link"></i></a></li>
        <li><a href="../resources/other.html">Other Resources</a></li>
    </ul>
</li>

            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Homework 7: Deployment</a><ul>
<li><a class="reference internal" href="#creating-your-homework-repository">Creating your homework repository</a></li>
<li><a class="reference internal" href="#task-1-create-a-heroku-app">Task 1: Create a Heroku App</a></li>
<li><a class="reference internal" href="#task-2-deploy-using-heroku-cli">Task 2: Deploy using Heroku CLI</a></li>
<li><a class="reference internal" href="#task-3-create-github-actions-for-helloapp">Task 3: Create GitHub Actions for HelloApp</a></li>
<li><a class="reference internal" href="#task-4-deploy-using-github-integration">Task 4: Deploy using Github Integration</a></li>
<li><a class="reference internal" href="#submitting-your-homework">Submitting your homework</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="homework-7-deployment">
<h1>Homework 7: Deployment<a class="headerlink" href="#homework-7-deployment" title="Permalink to this headline">¶</a></h1>
<p><strong>Due:</strong> Wednesday, May 18th, 8pm CDT</p>
<p>Last week, you learned about Continuous Integration, which deals with
how application code makes it to the master branch. But how do our
applications make it to the <em>real world</em>, where other people can use
them?</p>
<p>Deployment refers to the processes by which software systems are made
available for use (a related term, <em>delivery</em>, refers to making software
available specifically to end-users). The exact deployment pipeline can
vary from one project to another. For example, in a large financial
company, deploying business management software might require system
architects to come and physically upload software on the machines. On
the other hand, if you’re deploying a small web application, you just
need a way to get your application from your computer to a server where
other users can access it.</p>
<p>In this homework, you will deploy an application to
<a class="reference external" href="https://www.heroku.com/">Heroku</a>, one of the most popular services
for hosting web apps. More specifically, you’ll be deploying HelloApp,
the small <a class="reference external" href="http://flask.pocoo.org/">Flask</a> web application we
demonstrated in this week’s lectures (you can see our deployed version
here: <a class="reference external" href="https://cs220-helloapp.herokuapp.com/">https://cs220-helloapp.herokuapp.com/</a>). Don’t worry: while the app
is implemented in Python, no Python knowledge is necessary for this homework.</p>
<div class="section" id="creating-your-homework-repository">
<h2>Creating your homework repository<a class="headerlink" href="#creating-your-homework-repository" title="Permalink to this headline">¶</a></h2>
<p>Like previous homeworks, we will provide you with an <em>invitation URL</em> that
will allow you sign up for the homework assignment on GitHub, and which will
result in the creation of a repository called
<code class="docutils literal notranslate"><span class="pre">hw7-GITHUB_USERNAME</span></code> inside our <code class="docutils literal notranslate"><span class="pre">uchicago-cmsc22000-2022</span></code> organization
on GitHub.</p>
<p>Your repository will be seeded with some files for the homework
and, more specifically, will contain the code for HelloApp.</p>
</div>
<div class="section" id="task-1-create-a-heroku-app">
<h2>Task 1: Create a Heroku App<a class="headerlink" href="#task-1-create-a-heroku-app" title="Permalink to this headline">¶</a></h2>
<p>Heroku is a common service used to host web applications. For this task
you’ll sign up for a (free) account and use it to deploy an app with an
Internet-reachable URL.</p>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="https://signup.heroku.com/login">https://signup.heroku.com/login</a></p></li>
<li><p>Sign up and mark your “role” as “student”. You will need to confirm
your account, and then create a password.</p></li>
</ol>
<p>Once you’ve created your account, you’re ready to create a Heroku app.</p>
<ol class="arabic simple">
<li><p>Go to your dashboard, <a class="reference external" href="https://dashboard.heroku.com/apps">https://dashboard.heroku.com/apps</a></p></li>
<li><p>Click the button that says “New” and then click on “Create new app”</p></li>
<li><p>Under “App name” title your app <code class="docutils literal notranslate"><span class="pre">CNETID-cs220-hw7</span></code> (where
<code class="docutils literal notranslate"><span class="pre">CNETID</span></code> should be replaced with your CNetID). This means that the
url for your app will be <code class="docutils literal notranslate"><span class="pre">https://CNETID-cs220-hw7.herokuapp.com</span></code></p></li>
<li><p>Leave all other fields as-is. Click on “Create app”</p></li>
</ol>
<p>You’ve created your app! But navigate to
<code class="docutils literal notranslate"><span class="pre">https://CNETID-cs220-hw7.herokuapp.com</span></code>. As you can see, there’s
nothing there. In the coming tasks we will get HelloApp up and running
on this URL.</p>
<p>Before continuing, enter the URL of your Heroku app on Gradescope.</p>
</div>
<div class="section" id="task-2-deploy-using-heroku-cli">
<h2>Task 2: Deploy using Heroku CLI<a class="headerlink" href="#task-2-deploy-using-heroku-cli" title="Permalink to this headline">¶</a></h2>
<p>In class, we saw that we can deploy an app to Heroku simply by pushing
to their Git repository. Your local <code class="docutils literal notranslate"><span class="pre">hw7-GITHUB_USERNAME</span></code>
repository is currently configured to push only to GitHub, so we need to
set it up to also push to Heroku. We can do this using a command-line
tool provided by Heroku. This command-line tool is available on the CSIL machines
and the <code class="docutils literal notranslate"><span class="pre">linux.cs</span></code> servers.</p>
<p>First, you’ll need to log into Heroku using one of the methods described
below. Before doing this, make sure you’ve cloned your homework repository,
and that you are <em>inside</em> your <code class="docutils literal notranslate"><span class="pre">hw7-GITHUB_USERNAME</span></code> directory before
you run any of the commands below:</p>
<ul>
<li><p><strong>If running on an SSH connection to a CS Linux server</strong>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ heroku login -i
</pre></div>
</div>
<p>This will ask you for your Heroku username and password on the terminal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you get the following error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>›   Error: Your account has MFA enabled; API requests using
›   basic authentication with email and password are not supported.
›   Please generate an authorization token for API access.
</pre></div>
</div>
<p>You will need to go into your <a class="reference external" href="https://dashboard.heroku.com/account">Heroku account settings</a>,
scroll down to “API Key”, click “Reveal”, and use the key shown there instead of your
password when logging in from the command-line.</p>
</div>
</li>
<li><p><strong>If running on a CSIL machine or a CS Virtual Desktop</strong>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ heroku login
</pre></div>
</div>
<p>This will open a browser where you will be able to log into
Heroku.</p>
<p>Note: If you get an error about an “IP address mismatch”, please
try using the <code class="docutils literal notranslate"><span class="pre">-i</span></code> option as described above.</p>
</li>
<li><p><strong>If running on the CS Virtual Machine</strong>:</p>
<p>You will need to install Flask
and the <code class="docutils literal notranslate"><span class="pre">heroku</span></code> command by running the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ sudo -H pip3 install flask
$ sudo snap install --classic heroku
</pre></div>
</div>
<p>Then, run <code class="docutils literal notranslate"><span class="pre">heroku</span> <span class="pre">login</span></code> as described above.</p>
</li>
</ul>
<p>Next, we need to connect our local repository to Heroku’s
Git repository:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ heroku git:remote -a CNETID-cs220-hw7
</pre></div>
</div>
<p>So, we’ve set up Heroku for this app, but we haven’t deployed it yet
(if you navigate to your app’s webpage, and you’ll see there is still nothing there).</p>
<p>In order to deploy, you need to run the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ git push heroku main
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">heroku</span> <span class="pre">git:remote</span></code> command you ran above added the <code class="docutils literal notranslate"><span class="pre">heroku</span></code>
remote to your local repository, and pushing to it means that Heroku’s
servers will receive your code for the first time. The deployment will
take about a minute or so and, once it’s done, you should see a message
like this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>remote: -----&gt; Launching...
remote:        Released v3
remote:        https://CNETID-cs220-hw7.herokuapp.com/ deployed to Heroku
remote:
remote: Verifying deploy... <span class="k">done</span>.
To https://git.heroku.com/CNETID-cs220-hw7.git
 * <span class="o">[</span>new branch<span class="o">]</span>      main -&gt; main
</pre></div>
</div>
<p>Go ahead and go to <code class="docutils literal notranslate"><span class="pre">https://CNETID-cs220-hw7.herokuapp.com/</span></code>.
HelloApp should now be running correctly at that URL.</p>
<p>The version you just deployed happens to be a correct version of the
app. We actually have a few tests that will run some basic checks to
make sure the app is behaving as intended. You can run these tests simply
by running this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ pytest
</pre></div>
</div>
<p>This should produce an output like this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">=============================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">==============================</span>
platform linux -- Python <span class="m">3</span>.8.5, pytest-3.9.1, py-1.10.0, pluggy-0.13.1
rootdir: /home/CNETID/cs220/CNETID-cs220-hw7, inifile:
plugins: json-0.4.0, metadata-1.7.0, html-1.19.0, timeout-1.3.2
collected <span class="m">2</span> items

tests/test_greeting.py ..                                                <span class="o">[</span><span class="m">100</span>%<span class="o">]</span>

<span class="o">===========================</span> <span class="m">2</span> passed <span class="k">in</span> <span class="m">0</span>.06 <span class="nv">seconds</span> <span class="o">===========================</span>
</pre></div>
</div>
<p>Now, let’s break our app. Edit the file <code class="docutils literal notranslate"><span class="pre">hello/templates/index.html</span></code>
and replace <code class="docutils literal notranslate"><span class="pre">Hello</span></code> with <code class="docutils literal notranslate"><span class="pre">Howdy</span></code> on line 10. If you re-run the tests, one test
will pass, but another will fail:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">=============================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">==============================</span>
platform linux -- Python <span class="m">3</span>.8.5, pytest-3.9.1, py-1.10.0, pluggy-0.13.1
rootdir: /home/CNETID/cs220/CNETID-cs220-hw7, inifile:
plugins: json-0.4.0, metadata-1.7.0, html-1.19.0, timeout-1.3.2
collected <span class="m">2</span> items

tests/test_greeting.py .F                                                <span class="o">[</span><span class="m">100</span>%<span class="o">]</span>

<span class="o">===================================</span> <span class="nv">FAILURES</span> <span class="o">===================================</span>
________________________________ test_greeting _________________________________

<span class="nv">client</span> <span class="o">=</span> &lt;FlaskClient &lt;Flask <span class="s1">&#39;hello.main&#39;</span>&gt;&gt;

    def test_greeting<span class="o">(</span>client<span class="o">)</span>:
        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Test that we get the correct greeting</span>
<span class="s2">        if we submit the form.</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="nv">name</span> <span class="o">=</span> b<span class="s2">&quot;Random J. Hacker&quot;</span>
        <span class="nv">greeting</span> <span class="o">=</span> GREETING + b<span class="s2">&quot;, &quot;</span> + name + b<span class="s2">&quot;!&quot;</span>

        <span class="nv">rv</span> <span class="o">=</span> client.post<span class="o">(</span><span class="s2">&quot;/&quot;</span>, <span class="nv">data</span><span class="o">={</span><span class="s2">&quot;name&quot;</span>: name<span class="o">})</span>

        <span class="c1"># Test that the resulting page contains the app name</span>
        <span class="c1"># and the correct greeting.</span>
        assert APPNAME <span class="k">in</span> rv.data
&gt;       assert greeting <span class="k">in</span> rv.data
E       assert b<span class="s1">&#39;Hello, Random J. Hacker!&#39;</span> <span class="k">in</span> b<span class="s1">&#39;&lt;!doctype html&gt;\n&lt;title&gt;HelloApp&lt;/title&gt;\n&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/style.css&quot;&gt;\n&lt;nav&gt;\n  &lt;h1&gt;HelloApp&lt;/h...h1&gt;\n\n  &lt;/header&gt;\n  \n\n&lt;p&gt;\n  Howdy, Random J. Hacker!\n&lt;/p&gt;\n&lt;p&gt;\n  &lt;a href=&quot;/&quot;&gt;Again!&lt;/a&gt;\n&lt;/p&gt;\n\n\n\n&lt;/section&gt;&#39;</span>
E        +  where b<span class="s1">&#39;&lt;!doctype html&gt;\n&lt;title&gt;HelloApp&lt;/title&gt;\n&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/style.css&quot;&gt;\n&lt;nav&gt;\n  &lt;h1&gt;HelloApp&lt;/h...h1&gt;\n\n  &lt;/header&gt;\n  \n\n&lt;p&gt;\n  Howdy, Random J. Hacker!\n&lt;/p&gt;\n&lt;p&gt;\n  &lt;a href=&quot;/&quot;&gt;Again!&lt;/a&gt;\n&lt;/p&gt;\n\n\n\n&lt;/section&gt;&#39;</span> <span class="o">=</span> &lt;Response <span class="m">294</span> bytes <span class="o">[</span><span class="m">200</span> OK<span class="o">]</span>&gt;.data

tests/test_greeting.py:33: <span class="nv">AssertionError</span>
<span class="o">======================</span> <span class="m">1</span> failed, <span class="m">1</span> passed <span class="k">in</span> <span class="m">0</span>.11 <span class="nv">seconds</span> <span class="o">======================</span>
</pre></div>
</div>
<p>You don’t need to understand everything that’s going on here but, in a
nutshell, the tests verified that the index page of our application
works correctly, but one of the tests fail because the greeting we’re
receiving is “Howdy” instead of “Hello”.</p>
<p>It’s a good thing we have the tests to tell us this but, unfortunately,
nothing is preventing us from deploying this broken app. In fact, go
ahead and deploy the broken code:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ git add hello/templates/index.html
$ git commit -m <span class="s2">&quot;Broke the Internet!&quot;</span>
$ git push heroku main
</pre></div>
</div>
<p>As you’ll notice, you’re still able to deploy your app. But it’s now
returning the wrong greeting, and millions of users are upset because
they were expecting a polite “Hello” from the app, and now they’re
getting a much more folksy “Howdy”, which seems to rub some of our users
the wrong way.</p>
<p>Is there a way we could prevent this, without manually checking every
time? It would be nice if we could just deploy automatically from our
GitHub repo, and only after CI tests pass.</p>
<p>Before continuing, make sure that you also push to your GitHub
repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git push
</pre></div>
</div>
<p>That way, we can check that you’ve followed the steps described in this
task. You do not need to enter anything into Gradescope for this task.</p>
</div>
<div class="section" id="task-3-create-github-actions-for-helloapp">
<h2>Task 3: Create GitHub Actions for HelloApp<a class="headerlink" href="#task-3-create-github-actions-for-helloapp" title="Permalink to this headline">¶</a></h2>
<p>As you may remember from our <a class="reference external" href="hw6.html">previous homework</a>,
we have a way to make sure our app passes all the tests every time we
push.</p>
<p>For this task, you should create a <code class="docutils literal notranslate"><span class="pre">.github/workflows/test-app.yml</span></code> file in your
<code class="docutils literal notranslate"><span class="pre">hw7-GITHUB_USERNAME</span></code> repo. With Python, there’s no need to
build, so your job should only do the following:</p>
<ul>
<li><p>Checkout the repository using the <code class="docutils literal notranslate"><span class="pre">actions/checkout&#64;v3</span></code> action.</p></li>
<li><p>Install the required Python libraries by running the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">H</span> <span class="n">pip3</span> <span class="n">install</span> <span class="n">pytest</span> <span class="n">flask</span>
</pre></div>
</div>
</li>
<li><p>Run the tests by running the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">verbose</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the above to work, you need to make sure your workflow runs on
the <code class="docutils literal notranslate"><span class="pre">ubuntu-latest</span></code> environment.</p>
</div>
<p>In the last task, you made the tests fail. Commit and push your
workflow file and make sure the run fails specifically because the
tests are failing (you will need to inspect the job steps to see that
<code class="docutils literal notranslate"><span class="pre">pytest</span></code> is failing). Take the URL of the failed workflow
run, and enter it in Gradescope. Remember that it will look something
like this (where <cite>XXXXXXXX`</cite> will be a number):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">uchicago</span><span class="o">-</span><span class="n">cmsc22000</span><span class="o">-</span><span class="mi">2022</span><span class="o">/</span><span class="n">hw7</span><span class="o">-</span><span class="n">GITHUB_USERNAME</span><span class="o">/</span><span class="n">actions</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">XXXXXXXX</span>
</pre></div>
</div>
</div>
<div class="section" id="task-4-deploy-using-github-integration">
<h2>Task 4: Deploy using Github Integration<a class="headerlink" href="#task-4-deploy-using-github-integration" title="Permalink to this headline">¶</a></h2>
<p>Wouldn’t it be convenient if we could deploy continuously, as soon as
tests pass? As it turns out, GitHub Actions provides an “action”
for that: <a class="reference external" href="https://github.com/marketplace/actions/deploy-to-heroku">https://github.com/marketplace/actions/deploy-to-heroku</a>. More
generally, GitHub provides an entire <a class="reference external" href="https://github.com/marketplace?type=actions">marketplace of different actions</a>
that you can use in your CI workflow.</p>
<p>To use this action, add the following at the bottom of your <code class="docutils literal notranslate"><span class="pre">.github/workflows/test-app.yml</span></code>
file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- name: Deploy to Heroku
  uses: akhileshns/heroku-deploy@v3.12.12
  with:
    heroku_api_key: ${{secrets.HEROKU_API_KEY}}
    heroku_app_name: &quot;CNETID-cs220-hw7&quot;
    heroku_email: &quot;HEROKU_EMAIL&quot;
</pre></div>
</div>
<p>Make sure to replace <code class="docutils literal notranslate"><span class="pre">CNETID</span></code> with your CNetID, and <code class="docutils literal notranslate"><span class="pre">HEROKU_EMAIL</span></code> with the
e-mail you used to sign up for a Heroku account.</p>
<p>Next, to be able to deploy your app, GitHub Actions needs to be
able to use your Heroku account. Instead of giving GitHub your
username and password, we are going to provide an <em>API key</em>.
You can think of this as a separate password that other websites
(like GitHub) can use to access your account on Heroku.</p>
<p>To get your API key, you will need to go into your <a class="reference external" href="https://dashboard.heroku.com/account">Heroku account settings</a>,
scroll down to “API Key”, click “Reveal”, and then copy the key shown there.
Ultimately, we need to assign that key to the <code class="docutils literal notranslate"><span class="pre">heroku_api_key</span></code> field,
but you should never NEVER <strong>NEVER</strong>
add your API key (or any sort of password) to a file on a code repository.
This can be a huge security risk.</p>
<p>Instead, we are telling GitHub actions to use a variable called <code class="docutils literal notranslate"><span class="pre">secrets.HEROKU_API_KEY</span></code>.
To assign a value to that variable, go to your repository on GitHub, and do the following:</p>
<ul class="simple">
<li><p>Click on the <em>Settings</em> Tab</p></li>
<li><p>Then click on <em>Secrets</em> in the left sidebar. This will reveal a pull-down list;
click on <em>Actions</em></p></li>
<li><dl class="simple">
<dt>Click on “New repository secret”</dt><dd><ul>
<li><p>In the “Name” field, enter: <code class="docutils literal notranslate"><span class="pre">HEROKU_API_KEY</span></code></p></li>
<li><p>In the “Value” field, paste the API key you obtained earlier.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Ok, we’re almost ready to deploy from GitHub Actions. Before doing so,
let’s make sure we’re deploying a correct version of the app.
Fix the app so that the tests pass again and, once you’re sure
they’re passing locally, commit all your changes (don’t forget
to also commit your changes to <code class="docutils literal notranslate"><span class="pre">.github/workflows/test-app.yml</span></code>).
Now, push them to your repository; if you go to your repository’s Actions, you’ll see a new workflow
run that includes a “Deploy to Heroku” step (which should run successfully).
Enter the URL of this successful workflow run into Gradescope.</p>
<p>If you go to your app on Heroku, you’ll see that it works as expected.
Now, let’s try to deploy a broken version. Make the tests fail again and
push to GitHub with a simple <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>.
<em>Do not</em> run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">heroku</span> <span class="pre">main</span></code>, as this will force a deployment
of your (now broken) app. Instead, we want GitHub Actions
to detect when we’ve pushed a new version to GitHub <em>and</em> only
deploy it if it passes all the CI tests.</p>
<p>If you go to your repository’s Actions, you should now see a failed
workflow run (and, specifically, one where the tests fail, which results
in the “Deploy to Heroku” step not running). Take the URL of this workflow
run, and enter it into Gradescope.</p>
<p>If you navigate to your app’s URL, you’ll see that the broken version has not been deployed.</p>
</div>
<div class="section" id="submitting-your-homework">
<h2>Submitting your homework<a class="headerlink" href="#submitting-your-homework" title="Permalink to this headline">¶</a></h2>
<p>In this homework, you just need to enter a few URLs into Gradescope (make
sure you’ve done so at the points instructed above). You should also
make sure you’ve pushed your code to GitHub (but you will not be submitting
your code through Gradescope; we just need to check that you’ve made the
commits we expected you to make).</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011-2021, The University of Chicago.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>