
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

<title>Homework 4: Debugging &#8212; CMSC 22000 - Introduction to Software Development</title>

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <link rel="stylesheet" type="text/css" href="../_static/chiweb.css?v=4e80c602" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          CMSC 22000 - Introduction to Software Development</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              
              
            
            
            
<li><a href="../syllabus.html">Syllabus</a></li>
<li><a href="../calendar.html">Calendar</a></li>
<li><a href="../project.html">Project</a></li>

            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="homework-4-debugging">
<h1>Homework 4: Debugging<a class="headerlink" href="#homework-4-debugging" title="Link to this heading">¶</a></h1>
<p><strong>Due:</strong> Wednesday, April 27th, 8pm CDT</p>
<p>In this homework, you will get some practice debugging a few programs and, in
particular, will resolve some of the errors we described in class. In
some of the tasks, you will also become more familiar with GDB, a
popular debugger.</p>
<p>Some of the tasks in this homework will require reading through the <a class="reference external" href="https://uchicago-cs.github.io/debugging-guide/">Debugging
Guide</a>, which covers
(and expands on) many of the topics we covered in class. You can either read through
the guide before starting the homework, or read through the pertinent sections as needed
(we will point which ones you need to read throughout the homework).</p>
<section id="creating-your-homework-repository">
<h2>Creating your homework repository<a class="headerlink" href="#creating-your-homework-repository" title="Link to this heading">¶</a></h2>
<p>Like previous homeworks, we will provide you with an <em>invitation URL</em> that
will allow you sign up for the homework assignment on GitHub, and which will
result in the creation of a repository called
<code class="docutils literal notranslate"><span class="pre">hw4-GITHUB_USERNAME</span></code> inside our <code class="docutils literal notranslate"><span class="pre">uchicago-cmsc22000-2022</span></code> organization
on GitHub. Like Homework #3, your repository will be seeded with some files
for the homework.</p>
<p>Please note that, while you will be modifying some of the files we give
you, in this homework we will mostly be looking at the answers you provide to
a number of questions on Gradescope. Nonetheless, you should still push
your changes to your repository, in case we need to look at your code.</p>
</section>
<section id="task-1-compiler-linker-error-debugging">
<h2>Task 1: Compiler/Linker Error Debugging<a class="headerlink" href="#task-1-compiler-linker-error-debugging" title="Link to this heading">¶</a></h2>
<p>Read the <a class="reference external" href="https://uchicago-cs.github.io/debugging-guide/">Debugging
Guide</a> up to (and including)
the “Build Errors” section (i.e., stop when you get to “Runtime Errors”).</p>
<p>Your repository includes the following two files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">examples/compiler-error.c</span></code>: This file will produce a compiler error when compiled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">examples/compiler-warning.c</span></code>: This file will compile, but will produce a compiler warning.</p></li>
</ul>
<p>Compile each of these files (you can simply run
<code class="docutils literal notranslate"><span class="pre">gcc</span> <span class="pre">&lt;filename&gt;.c</span> <span class="pre">-o</span> <span class="pre">&lt;filename&gt;</span></code>). Your goal is to fix the code to address the
error or warning in each of them (note: you are not allowed to just comment out
the responsible line of code). On Gradescope, you must provide the
following information for each file:</p>
<ul class="simple">
<li><p>In each file, there is a singular line that is responsible for the error or warning.
You must show the “before” and “after” version of that line (i.e., before you fixed
the code, and after you fixed the code). Remember that the line reported
by the compiler may not be the one responsible for the error/warning!</p></li>
<li><p>Briefly describe what was causing the error/warning and how you fixed it.</p></li>
</ul>
<p>Make sure to actually fix the errors in the C file (and make sure to commit
and push this fix to your repository).</p>
</section>
<section id="gdb-warmup">
<h2>GDB Warmup<a class="headerlink" href="#gdb-warmup" title="Link to this heading">¶</a></h2>
<p>Read up to, and including, the “Using a debugger” section of the <a class="reference external" href="https://uchicago-cs.github.io/debugging-guide/">Debugging
Guide</a> (i.e., stop when you
get to “Preemptive Techniques”). The guide
itself does not go into details on how to use a debugger, like GDB,
to debug these kind of errors. That is what we will do in this section
of the homework.</p>
<p>GDB, short for GNU Debugger, is a debugger for Unix-like systems and
works for languages like C and C++. It essentially allows you to inspect
and dissect your program as it is running, which is super helpful for
finding errors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Besides being familiar with GDB on the command-line, you
may want to also become familiar with how graphical debuggers work. Here
are a few options you may want to check out:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://gdbgui.com/">gdbgui</a> allows you to work with GDB through
a browser-based interface, allowing you to better visualize the state
of your program while you’re debugging it.</p></li>
<li><p>VSCode has built-in <a class="reference external" href="https://code.visualstudio.com/docs/editor/debugging">debugging
support</a>.</p></li>
<li><p>Most IDEs, including CLion, have <a class="reference external" href="https://www.jetbrains.com/clion/features/run-and-debug.html">excellent built-in
debuggers</a>.</p></li>
</ul>
<p>While the homework instructions are written for the terminal-based gdb, we
encourage you to learn about a graphical debugger on your own after
you’ve completed this homework. Take into account that these graphical
debuggers all use gdb in the backend, which means that everything you’ll
learn about the terminal-based gdb will translate well into a graphical
debugger.</p>
</div>
<p>Your repository includes an <code class="docutils literal notranslate"><span class="pre">examples/gdb-warmup.c</span></code> file that we will
use to familiarize ourselves with GDB. From inside the <code class="docutils literal notranslate"><span class="pre">examples/</span></code> directory,
compile the program with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="o">-</span><span class="n">g</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">o</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span>
</pre></div>
</div>
<p>Notice the use of the <code class="docutils literal notranslate"><span class="pre">-g</span></code> flag. This enables built-in debugging
support. To start gdb, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdb</span> <span class="o">./</span><span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">gdb</span></code> starts the debugger, and <code class="docutils literal notranslate"><span class="pre">./gdb-warmup</span></code> specifies the program we
are debugging. Now that <code class="docutils literal notranslate"><span class="pre">gdb</span></code> is running, you can start the program by
typing <code class="docutils literal notranslate"><span class="pre">run</span></code>. This program won’t actually print anything and, if you
look at the code, it doesn’t do anything particularly useful, but
it will allow us to showcase some simple GDB commands.</p>
<p>For example, we may want to stop at certain points in the program. We can
do this by setting <em>breakpoints</em>. These could be done in one of the following ways using
the command <code class="docutils literal notranslate"><span class="pre">break</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">break</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="n">line_number</span>
<span class="k">break</span> <span class="n">function_name</span>
</pre></div>
</div>
<p>The first one sets a breakpoint at the provided line number, and the
second sets it at the start of the provided function. You can set
multiple breakpoints. Notice that, to break right when the program
starts, you can just set a breakpoint on the <code class="docutils literal notranslate"><span class="pre">main</span></code> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">break</span> <span class="n">main</span>
</pre></div>
</div>
<p>When you reach a breakpoint, execution of the program will pause at that
breakpoint. If you want to continue running the program, then type
<code class="docutils literal notranslate"><span class="pre">continue</span></code>. Careful: if you type <code class="docutils literal notranslate"><span class="pre">run</span></code>, it will restart the
execution of the program from the beginning.</p>
<p>To look at all the breakpoints you have, run <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">breakpoints</span></code>, and
you will see a numbered list of breakpoints. Run <code class="docutils literal notranslate"><span class="pre">delete</span></code> to delete
all breakpoints. If you specify a number with delete, for example
<code class="docutils literal notranslate"><span class="pre">delete</span> <span class="pre">2</span></code>, the breakpoint corresponding to that number on the list
will be deleted.</p>
<p>It would be annoying to have to set a breakpoint for every line of code
you want to look at, especially if they are consecutive. A useful
command for this is <code class="docutils literal notranslate"><span class="pre">next</span></code>.</p>
<p>Let’s give all of this a try. Make sure you are running GDB as described
earlier:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdb</span> <span class="o">./</span><span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span>
</pre></div>
</div>
<p>Then, from the GDB prompt, set the following breakpoint:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">break</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">35</span>
</pre></div>
</div>
<p>Now, run the program (by typing <code class="docutils literal notranslate"><span class="pre">run</span></code> in the GDB prompt). It should break at line 35, showing something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">35</span>
<span class="mi">35</span>      <span class="o">*</span><span class="n">p</span> <span class="o">+=</span> <span class="mi">5</span><span class="p">;</span>
</pre></div>
</div>
<p>At this point, line 35 has not yet been run. If you type <code class="docutils literal notranslate"><span class="pre">next</span></code>, gdb
will run line 35, and will advance to the <em>next</em> line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">35</span>
<span class="mi">35</span>      <span class="o">*</span><span class="n">p</span> <span class="o">+=</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="nb">next</span>
<span class="mi">36</span>      <span class="n">c</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span>
</pre></div>
</div>
<p>Please note that, if you want to run through the next lines, you don’t
have to keep typing <code class="docutils literal notranslate"><span class="pre">next</span></code>. After using <code class="docutils literal notranslate"><span class="pre">next</span></code> a first time, you can
just hit the Enter key to keep running through the program line by line.</p>
<p>A similar command is <code class="docutils literal notranslate"><span class="pre">step</span></code> which, like <code class="docutils literal notranslate"><span class="pre">next</span></code>, will execute the
next line of code, but will handle function calls differently. If you
are in function <code class="docutils literal notranslate"><span class="pre">foo</span></code>, and <code class="docutils literal notranslate"><span class="pre">foo</span></code> calls <code class="docutils literal notranslate"><span class="pre">bar</span></code>, <code class="docutils literal notranslate"><span class="pre">step</span></code> allows you
to go line-by-line through <code class="docutils literal notranslate"><span class="pre">bar</span></code> as well when it is called in <code class="docutils literal notranslate"><span class="pre">foo</span></code>,
whereas <code class="docutils literal notranslate"><span class="pre">next</span></code> would execute <code class="docutils literal notranslate"><span class="pre">bar</span></code> without letting you step through
it and execute the next line of <code class="docutils literal notranslate"><span class="pre">foo</span></code>. Look at the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>int bar() {
    int x = 1;
    printf(“I’m in bar!”);
    return x;
}

int foo() {
    printf(“I’m in foo!”);
    int x = bar();
    x++;
    return x;
}
</pre></div>
</div>
<p>When you get to the second line of <code class="docutils literal notranslate"><span class="pre">foo()</span></code>, if you use <code class="docutils literal notranslate"><span class="pre">step</span></code> you
will go to the first line of <code class="docutils literal notranslate"><span class="pre">bar</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">1;</span></code>), whereas if you
use <code class="docutils literal notranslate"><span class="pre">next</span></code> you will go to the next line in <code class="docutils literal notranslate"><span class="pre">foo</span></code> (<code class="docutils literal notranslate"><span class="pre">x++;</span></code>). If you
do use <code class="docutils literal notranslate"><span class="pre">step</span></code>, once you return from <code class="docutils literal notranslate"><span class="pre">bar</span></code>, you then execute the next
line in <code class="docutils literal notranslate"><span class="pre">foo</span></code> (<code class="docutils literal notranslate"><span class="pre">x++;</span></code>).</p>
<p>As you are stepping through your program, you might want to be able to
see the values of certain variables. You can do this by running the
<code class="docutils literal notranslate"><span class="pre">print</span></code> command. <code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">val</span></code>, for example, will print the value
<code class="docutils literal notranslate"><span class="pre">val</span></code>. With pointers, you can use <code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">*p</span></code> to print out the value
pointed to by p. If you want to print in hex, use <code class="docutils literal notranslate"><span class="pre">print/x</span> <span class="pre">val</span></code>, and
to print in binary use <code class="docutils literal notranslate"><span class="pre">print/t</span> <span class="pre">val</span></code></p>
<p>There is also a useful command to keep track of when a variable changes.
This command is <code class="docutils literal notranslate"><span class="pre">watch</span></code> (careful: you can’t use this command before
you start running the program in GDB; otherwise, GDB won’t know what
variables are currently in scope). If you want to keep track of when the
variable <code class="docutils literal notranslate"><span class="pre">x</span></code> changes, type <code class="docutils literal notranslate"><span class="pre">watch</span> <span class="pre">x</span></code>. Every time it is changed when
you run your program or execute a line of code, the program will stop
and print the old and new values (note that it will break in the line
<em>after</em> the variable was changed).</p>
<p>When you’re done using gdb, you can exit by typing <code class="docutils literal notranslate"><span class="pre">quit</span></code> or by
pressing Ctrl+D. If the program you’re debugging is still running,
you will see the following message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>A debugging session is active.

    Inferior 1 [process 642037] will be killed.

Quit anyway? (y or n)
</pre></div>
</div>
<p>You can safely select <code class="docutils literal notranslate"><span class="pre">y</span></code> here.</p>
<p>If you’d like to practice using these commands a bit more, try doing
the following (you don’t have to answer these questions
on Gradescope; they are just for you to practice):</p>
<ul class="simple">
<li><p><strong>Practice Question A</strong>: Set a breakpoint at the start of the <code class="docutils literal notranslate"><span class="pre">main</span></code> function.
Can you find the line(s) where the value of variable <code class="docutils literal notranslate"><span class="pre">c</span></code> changes?</p></li>
<li><p><strong>Practice Question B</strong>: What is the value pointed to by pointer p after line 42?</p></li>
<li><p><strong>Practice Question C</strong>: Set a breakpoint at line 38. Print the value of variable <code class="docutils literal notranslate"><span class="pre">a</span></code> and step through lines 38-41,
then print the value of variable <code class="docutils literal notranslate"><span class="pre">a</span></code> after line 41.</p></li>
<li><p><strong>Practice Question D</strong>: What is the return value of the function <code class="docutils literal notranslate"><span class="pre">num()</span></code> in hexadecimal?</p></li>
</ul>
<p>You can find the answers to these questions at the end of this homework.</p>
</section>
<section id="the-micro-editor">
<h2>The Micro Editor<a class="headerlink" href="#the-micro-editor" title="Link to this heading">¶</a></h2>
<p>We’ve seen how GDB works with some simple examples, but now it’s time to debug
a more complex piece of software. We will be using the <code class="docutils literal notranslate"><span class="pre">micro</span></code> editor from
Homework #3. As a reminder, this is our version of the <a class="reference external" href="https://viewsourcecode.org/snaptoken/kilo/">kilo</a>
editor, a simple but functional text editor that can be implemented in about 1,000 lines of C
code.</p>
<p>You can build the <code class="docutils literal notranslate"><span class="pre">micro</span></code> editor by going into the <code class="docutils literal notranslate"><span class="pre">micro/</span></code> directory in
your repository and running the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="n">build</span><span class="o">/</span>
<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span><span class="o">/</span>
</pre></div>
</div>
<p>This will generate a <code class="docutils literal notranslate"><span class="pre">micro</span></code> executable inside a <code class="docutils literal notranslate"><span class="pre">build/</span></code> directory.
Let’s give it a try! Run the following from the <code class="docutils literal notranslate"><span class="pre">micro/</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">/</span><span class="n">micro</span>
</pre></div>
</div>
<p>This will open the editor with a “blank file”. You can start typing to edit
the file, and you’ll notice that you can move around with the arrow keys, use
the Backspace key, and the Delete key. You should be able to quit the editor
by pressing Ctrl-Q (if you modified the file, you’ll have to press it three
times to confirm you want to exit without saving).</p>
<p>However, we have inserted a few bugs in the code, so don’t be surprised if
you do something that makes the editor crash! Please note that, if this
happens, your terminal may be left in a seemingly unusable state (in particular,
it will seem like you can’t type anything into the terminal). When this happens,
press Enter followed by typing the word <code class="docutils literal notranslate"><span class="pre">reset</span></code> followed by pressing Enter (this doesn’t
reset your computer, it just resets your terminal). You can also just close the
terminal and open it up again.</p>
<p>Let’s say we wanted to debug this executable. We actually cannot call GDB like
before, because the text editor needs to use the entire terminal, so it
would be impractical to have a GDB prompt interfering with that. So, this will
allow us to do <em>remote debugging</em>, where the program and the debugger are
run separately (and could even be running in completely different computers,
and communicating over the network).</p>
<p>To do this, open two terminals (if you’re logging to a CS Linux server, make
sure you’re logged into the same Linux server on both terminals). On the first one, run the following from the
<code class="docutils literal notranslate"><span class="pre">micro/</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdbserver</span> <span class="p">:</span><span class="mi">50000</span> <span class="n">build</span><span class="o">/</span><span class="n">micro</span>
</pre></div>
</div>
<p>The editor won’t actually start just yet (this is normal!) and you’ll see something
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Process</span> <span class="n">build</span><span class="o">/</span><span class="n">micro</span> <span class="n">created</span><span class="p">;</span> <span class="n">pid</span> <span class="o">=</span> <span class="mi">549651</span>
<span class="n">Listening</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">50000</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you see the following message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Can</span><span class="s1">&#39;t bind address: Address already in use.</span>
<span class="n">Exiting</span>
</pre></div>
</div>
<p>Then pick a number other than 50000 in the parameter to <code class="docutils literal notranslate"><span class="pre">gdbserver</span></code>
(any number between 50000 and 60000 should work). This number is known
as a “port”, and we will be using it to connect to the editor from GDB.
We have to pick a number that is unique within the machine we are running
on; this means that if you are running this on one of the CS Linux server,
and multiple people choose 50000, only one of them will actually be able
to run the debugger.</p>
</div>
<p>Now, on the second terminal, run this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdb</span> <span class="n">build</span><span class="o">/</span><span class="n">micro</span>
</pre></div>
</div>
<p>This will open the usual GDB prompt but, instead of typing “run”, we need to
connect to the editor that is running on the other terminal. You need
to run the following command from the GDB prompt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="n">remote</span> <span class="p">:</span><span class="mi">50000</span>
</pre></div>
</div>
<p>Note: If you specified a different port number when running <code class="docutils literal notranslate"><span class="pre">gdbserver</span></code>, you must use that
number instead of <code class="docutils literal notranslate"><span class="pre">50000</span></code> when running <code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">remote</span></code>.</p>
<p>You will see something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(gdb) target remote :50000
Remote debugging using :50000
Reading /lib64/ld-linux-x86-64.so.2 from remote target...
warning: File transfers from remote targets can be slow. Use &quot;set sysroot&quot; to access files locally instead.
Reading /lib64/ld-linux-x86-64.so.2 from remote target...
Reading symbols from target:/lib64/ld-linux-x86-64.so.2...
Reading /lib64/ld-2.31.so from remote target...
Reading /lib64/.debug/ld-2.31.so from remote target...
Reading /usr/lib/debug//lib64/ld-2.31.so from remote target...
Reading /usr/lib/debug/lib64//ld-2.31.so from remote target...
Reading target:/usr/lib/debug/lib64//ld-2.31.so from remote target...
(No debugging symbols found in target:/lib64/ld-linux-x86-64.so.2)
0x00007ffff7fd0100 in ?? () from target:/lib64/ld-linux-x86-64.so.2
</pre></div>
</div>
<p>You can ignore the warning about file transfers being slow, or the message about
“No debugging symbols” (this refers to a system library, not to our editor)</p>
<p>You can now run any of the commands we’ve seen previously, with one caveat: once
you want to start running the editor, you must use the <code class="docutils literal notranslate"><span class="pre">continue</span></code> command,
and not the <code class="docutils literal notranslate"><span class="pre">run</span></code> command. In fact, try just running the <code class="docutils literal notranslate"><span class="pre">continue</span></code> command;
GDB will show something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
<span class="n">Reading</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">libc</span><span class="o">.</span><span class="n">so</span><span class="mf">.6</span> <span class="kn">from</span> <span class="nn">remote</span> <span class="n">target</span><span class="o">...</span>
<span class="n">Reading</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">libc</span><span class="o">-</span><span class="mf">2.31</span><span class="o">.</span><span class="n">so</span> <span class="kn">from</span> <span class="nn">remote</span> <span class="n">target</span><span class="o">...</span>
<span class="n">Reading</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/.</span><span class="n">debug</span><span class="o">/</span><span class="n">libc</span><span class="o">-</span><span class="mf">2.31</span><span class="o">.</span><span class="n">so</span> <span class="kn">from</span> <span class="nn">remote</span> <span class="n">target</span><span class="o">...</span>
<span class="n">Reading</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">debug</span><span class="o">//</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">libc</span><span class="o">-</span><span class="mf">2.31</span><span class="o">.</span><span class="n">so</span> <span class="kn">from</span> <span class="nn">remote</span> <span class="n">target</span><span class="o">...</span>
<span class="n">Reading</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">debug</span><span class="o">//</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">libc</span><span class="o">-</span><span class="mf">2.31</span><span class="o">.</span><span class="n">so</span> <span class="kn">from</span> <span class="nn">remote</span> <span class="n">target</span><span class="o">...</span>
</pre></div>
</div>
<p>And, on the first terminal, the editor will start running.</p>
<p>If you need to quit the editor, we suggest doing so from the first terminal
(by pressing Ctrl-Q). If you start the editor again on the first terminal,
you can actually “reattach” the debugger by running <code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">remote</span> <span class="pre">:50000</span></code>
again from inside GDB. You don’t have to also quit GDB and start it again.</p>
<p>You can also force the editor to terminate the
program by pressing Ctrl-C in GDB, followed by Ctrl-D. Please note that this
may leave the first terminal in an unstable state (in the same way as described
above in the case of the editor crashing). If that happens, simply perform
the steps described earlier.</p>
</section>
<section id="task-2-stepping-through-the-micro-editor-code">
<h2>Task 2: Stepping Through the Micro Editor Code<a class="headerlink" href="#task-2-stepping-through-the-micro-editor-code" title="Link to this heading">¶</a></h2>
<p>(20 + 20 points)</p>
<p>As you can see in the <code class="docutils literal notranslate"><span class="pre">micro/src/main.c</span></code> file, the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function of our
editor is actually pretty simple and brief (in large part, thanks to the
modular design of the code which hides the various complexities of
running an editor). The <code class="docutils literal notranslate"><span class="pre">main()</span></code> function basically does the following:</p>
<ul>
<li><p>Enable “raw mode” on the terminal, which will allow the editor to effectively
take over the terminal and “draw” characters anywhere on it (when the terminal
is running in normal mode, we typically can only print to the terminal line
by line)</p></li>
<li><p>We initialize an <code class="docutils literal notranslate"><span class="pre">editor_ctx_t</span></code> struct, which we use as a context object
to store global information about the editor.</p></li>
<li><p>If a file was specified in the command-line when running the <code class="docutils literal notranslate"><span class="pre">micro</span></code> executable,
we load that file.</p></li>
<li><p>We set a status message at the bottom of the screen.</p></li>
<li><p>We enter an “event loop”, where we continously repeat the following two operations:</p>
<ul class="simple">
<li><p>We refresh the screen with the most up-to-date content of the editor.</p></li>
<li><p>We wait for a keypress (our “event”)</p></li>
</ul>
<p>Event loops are a common way of structuring interactive applications, where we just
wait for something to happen (in this case, input from the user), and then refresh the
contents of the screen based on that event. For example, if the user presses the <code class="docutils literal notranslate"><span class="pre">F</span></code>
key, we would expect an <code class="docutils literal notranslate"><span class="pre">F</span></code> to be inserted at the position of the cursor in the editor.</p>
</li>
</ul>
<p>When debugging our code, we may want to see how some of the fields of our context object
evolve as we use the editor. You must do the following:</p>
<ol class="arabic">
<li><p>Open file <code class="docutils literal notranslate"><span class="pre">samples/simple.txt</span></code> in the editor. Remember to do this using two terminals;
in one terminal run this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdbserver</span> <span class="p">:</span><span class="mi">50000</span> <span class="n">build</span><span class="o">/</span><span class="n">micro</span> <span class="n">samples</span><span class="o">/</span><span class="n">simple</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>In the other terminal, run this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdb</span> <span class="n">build</span><span class="o">/</span><span class="n">micro</span>
</pre></div>
</div>
<p>Notice how, when opening a file, we only need to specify the file in the first terminal,
when calling <code class="docutils literal notranslate"><span class="pre">gdbserver</span></code>.</p>
<p>You may also want to open a third terminal in case you need to inspect or edit any files
from a conventional editor.</p>
<p>On to our task: we would like to figure out the
exact line(s) in our code where the <code class="docutils literal notranslate"><span class="pre">ctx-&gt;num_rows</span></code>
variable is updated when we load a file. On Gradescope, specify the line(s) of code
where this happens, and copy-paste the full and unabridged GDB session that helped
you determine this.</p>
</li>
<li><p>Open file <code class="docutils literal notranslate"><span class="pre">samples/lorem-ipsum.txt</span></code> in the editor. We can press Ctrl-F to search
for a piece of text within the file. Internally, the <code class="docutils literal notranslate"><span class="pre">editor_find</span></code> function
will be called when this happens. Set one or more breakpoints that allow you to determine the
values of <code class="docutils literal notranslate"><span class="pre">ctx-&gt;cx</span></code> and <code class="docutils literal notranslate"><span class="pre">ctx-&gt;cy</span></code> after searching for the term <code class="docutils literal notranslate"><span class="pre">Integer</span></code>.
Please note that using <code class="docutils literal notranslate"><span class="pre">watch</span></code> in this task is impractical, since those values
actually can change a lot during a search, and all we’re interested in is their
final value.</p>
<p>So, in this particular task, it can be beneficial to read through the <code class="docutils literal notranslate"><span class="pre">editor_find</span></code> to
get a sense of where you should set the breakpoint, and at what point you’ll be able to
obtain the final values of <code class="docutils literal notranslate"><span class="pre">ctx-&gt;cx</span></code> and <code class="docutils literal notranslate"><span class="pre">ctx-&gt;cy</span></code>. On
Gradescope, specify those values and copy-paste the full and unabridged GDB session
that helped you determine this.</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This homework is also, indirectly, an exercise in diving into an existing codebase.
While we encourage you to read through the editor code to figure out what it does
(this is a very valuable skill!) you’re also welcome to ask us any questions you want
about the editor code itself.</p>
</div>
</section>
<section id="runtime-error-debugging">
<h2>Runtime Error Debugging<a class="headerlink" href="#runtime-error-debugging" title="Link to this heading">¶</a></h2>
<p>Runtime errors make the program crash while it is running, and sometimes
they are hard to find because the compiler doesn’t always give
particularly informative error messages.</p>
<p>For example, your repository includes an <code class="docutils literal notranslate"><span class="pre">examples/segfault.c</span></code> that will
crash with a segmentation fault when you run it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gcc -g segfault.c -o segfault
$ ./segfault
Segmentation fault (core dumped)
</pre></div>
</div>
<p>Segmentation faults (or “segfaults”) typically arise when we access memory we shouldn’t
be accessing (e.g., by using an uninitialized pointer). While we can
sometimes spot the issue by looking at the code, it would be nice
to know exactly where the segfault is happening.</p>
<p>GDB is a really useful tool because it helps you pinpoint where a segfault is
happening and what might be causing it. You can use all the commands
we’ve already talked about (e.g., to step through a program line
by line until it segfaults), but there are a couple of additional ones
that might be useful.</p>
<p><code class="docutils literal notranslate"><span class="pre">backtrace</span></code> will print out the call stack. What this means is that it
will print the function being called as well as the function that called
that, and the function that called that, etc. Using this command
after a segfault in GDB can often tell us exactly what is causing the
segfault.</p>
<p><code class="docutils literal notranslate"><span class="pre">frame</span> <span class="pre">n</span></code> (where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the frame number from the backtrace) allows
you to go to the function in that frame and see what line in that
particular function caused the error.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">backtrace</span></code> and <code class="docutils literal notranslate"><span class="pre">frame</span> <span class="pre">n</span></code> don’t reveal any useful information,
you may want to set breakpoints close to the point where the segfault happens,
to see exactly what happens in the lines leading up to the segfault. However,
to do this, you must first use the <code class="docutils literal notranslate"><span class="pre">kill</span></code> to stop the current run of the program
(without exiting GDB).
You will then be able to <code class="docutils literal notranslate"><span class="pre">run</span></code> the program again, stopping at any additional
breakpoints you specify.</p>
<p><strong>Practice Question E</strong>: Try running the <code class="docutils literal notranslate"><span class="pre">segfault</span></code> program with gdb and using the above
commands to figure out what is causing the segfault. You will find
the answer at the bottom of this homework.</p>
</section>
<section id="memory-debugging-with-valgrind">
<h2>Memory Debugging with Valgrind<a class="headerlink" href="#memory-debugging-with-valgrind" title="Link to this heading">¶</a></h2>
<p>Another useful tool for debugging runtime errors is <a class="reference external" href="https://valgrind.org/">Valgrind</a>,
a memory debugger that can alert you to incorrect memory accesses in your code. For example,
take a look at the <code class="docutils literal notranslate"><span class="pre">examples/buffer-overflow.c</span></code> file. In this program, we are intentionally
causing a <em>buffer overflow</em>: we allocated 13 bytes of memory for a string, but are then writing
14 bytes into it (the string <code class="docutils literal notranslate"><span class="pre">&quot;Hello,</span> <span class="pre">world!&quot;</span></code> only has 13 characters in it, but remember we
need an extra byte for the null terminator <code class="docutils literal notranslate"><span class="pre">\0</span></code>!)</p>
<p>Running the program doesn’t actually result in a segfault or any kind of error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gcc -g buffer-overflow.c -o buffer-overflow
$ ./buffer-overflow
Hello, world!
</pre></div>
</div>
<p>But these kind of incorrect memory accesses (where we’re writing into unallocated memory)
could result in a segfault or other error further down road, including in a completely
unrelated portion of our code. So, if you can’t debug an issue with GDB, it’s always
worth running Valgrind to check that there aren’t any inappropriate memory access
in your code.</p>
<p>To run Valgrind, simply run <code class="docutils literal notranslate"><span class="pre">valgrind</span></code> followed by the executable you want to debug:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ valgrind ./buffer-overflow
</pre></div>
</div>
<p>If you do this, you will see messages referring to an <code class="docutils literal notranslate"><span class="pre">Invalid</span> <span class="pre">write</span></code> when
<code class="docutils literal notranslate"><span class="pre">strcpy</span></code> is called, and to an <code class="docutils literal notranslate"><span class="pre">Invalid</span> <span class="pre">read</span></code> when <code class="docutils literal notranslate"><span class="pre">printf</span></code> is called.
These refer to lines of your code where unallocated memory is being accessed.</p>
<p>To fix the issue, change this line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">13</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">));</span>
</pre></div>
</div>
<p>To this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">14</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">));</span>
</pre></div>
</div>
<p>If you recompile the program and running with Valgrind, it should now report no issues.</p>
<p>Valgrind is also useful for detecting <em>memory leaks</em>: points in your program where
allocated memory isn’t being freed. For example, try commenting out this line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">free</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</pre></div>
</div>
<p>If you recompile and run the program with Valgrind, you will now see Valgrind
print a <code class="docutils literal notranslate"><span class="pre">LEAK</span> <span class="pre">SUMMARY</span></code> at the end, alerting you to the fact that 14 bytes were
<code class="docutils literal notranslate"><span class="pre">definitely</span> <span class="pre">lost</span></code>.</p>
<p>Finally, take into account that it is also a good idea to simply run Valgrind periodically,
even if nothing is visibly wrong with your code, as this may allow you to preemptively correct
incorrect memory accesses and memory leaks.</p>
</section>
<section id="task-3-fixing-runtime-errors-in-the-micro-editor">
<h2>Task 3: Fixing Runtime Errors in the Micro Editor<a class="headerlink" href="#task-3-fixing-runtime-errors-in-the-micro-editor" title="Link to this heading">¶</a></h2>
<p>We have inserted two bugs in the Micro code that will cause the editor to
crash, and which would be challenging to spot
just by code inspection, given the amount of code you’d have to read through.
This is where a debugger can make your life much easier!</p>
<section id="bug-1">
<h3>Bug #1<a class="headerlink" href="#bug-1" title="Link to this heading">¶</a></h3>
<p>The editor will crash if you try to save any file by pressing Ctrl-S.
That said, if you have trouble reproducing this issue, you can try
opening the provided <code class="docutils literal notranslate"><span class="pre">micro/samples/lorem-ipsum.txt</span></code> file. If you immediately
try to save it, the editor should segfault (you don’t even have to make
any modifications to the file).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the editor crashes, it may leave the terminal in an unstable state.
Remember that you can resolve this by pressing Enter followed by typing
the word <code class="docutils literal notranslate"><span class="pre">reset</span></code> followed by pressing Enter. You can also close and re-open
the terminal.</p>
</div>
<p>Use GDB to track down the source of the segfault, and to fix it. Provide
the following information on Gradescope:</p>
<ul class="simple">
<li><p>The full and unabridged gdb session you used to track down the segfault</p></li>
<li><p>Copy-paste the line where the segfault is happening.</p></li>
<li><p>Explain why the segfault is happening.</p></li>
<li><p>The before and after version of any lines of code you changed to
fix the bug. Remember: the line where the segfault happens may not
be the line you have to edit to fix the bug.</p></li>
</ul>
</section>
<section id="bug-2">
<h3>Bug #2<a class="headerlink" href="#bug-2" title="Link to this heading">¶</a></h3>
<p>(10 points)</p>
<p>If you place the cursor at the start of a line (other than the first line
of the file) and press the “Backspace” key, this will move the contents
of that line to the end of the previous line. For example, open the file
<code class="docutils literal notranslate"><span class="pre">micro/samples/lines-1.txt</span></code>, which contains the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AAAAAAAAAA</span>
<span class="n">BBBBBBBBBB</span>
</pre></div>
</div>
<p>If you place the cursor at the start of the second line and press “Backspace”,
the editor will now display this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AAAAAAAAAABBBBBBBBBB</span>
</pre></div>
</div>
<p>So far, so good. However, try doing the same thing with the file
<code class="docutils literal notranslate"><span class="pre">micro/samples/lines-2.txt</span></code>, where the second line is much longer than the first.
The editor will now crash with an error like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">munmap_chunk</span><span class="p">():</span> <span class="n">invalid</span> <span class="n">pointer</span>
<span class="n">Aborted</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span>
</pre></div>
</div>
<p>This is not a segfault, but we can debug it with GDB following the same steps
we followed to debug a segfault (this error is alerting
us to the fact that a system library received an invalid pointer, which may help us
narrow down the issue).</p>
<p>That said, this bug is much more insidious than the previous one: the line that
causes the editor to crash is actually a <em>spurious error</em>. There is actually nothing
wrong with that line or even with the variable that is being manipulated in that line.
However, something in the lines of code leading up to that line has corrupted the
editor’s data structures, causing that variable to contain an
invalid pointer. So, to debug this issue, you should look at what happens before
the line that causes the crash (including prior functions in the backtrace) to
see if you can spot anything wrong.</p>
<p>For this task, you must provide the following information on Gradescope:</p>
<ul class="simple">
<li><p>The full and unabridged gdb session you used to track down the crash</p></li>
<li><p>Copy-paste the line that where the crash is happening.</p></li>
<li><p>Identify the programming error that leads to that crash happening.</p></li>
<li><p>The before and after version of any lines of code you changed to
fix the bug.</p></li>
</ul>
</section>
</section>
<section id="submitting-your-homework">
<h2>Submitting your homework<a class="headerlink" href="#submitting-your-homework" title="Link to this heading">¶</a></h2>
<p>Please note that you will not be submitting your code through
Gradescope. Instead, make sure that the questions posed in each task are
answered on Gradescope. That said, we still need you to push your code
in case we need to look at any of your code (but we will not be grading
the code itself).</p>
</section>
<section id="answers-to-practice-questions">
<h2>Answers to Practice Questions<a class="headerlink" href="#answers-to-practice-questions" title="Link to this heading">¶</a></h2>
<p><strong>Practice Question A</strong></p>
<p>Variable <code class="docutils literal notranslate"><span class="pre">c</span></code> changes at lines 34, 36, 44, 47, 53, 55, 56.</p>
<p>Notice how GDB will break in the line <em>after</em> the variable changes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">break</span> <span class="n">main</span>
<span class="n">Breakpoint</span> <span class="mi">3</span> <span class="n">at</span> <span class="mh">0x5555555551c0</span><span class="p">:</span> <span class="n">file</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">line</span> <span class="mf">30.</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">run</span>
<span class="n">Starting</span> <span class="n">program</span><span class="p">:</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span>

<span class="n">Breakpoint</span> <span class="mi">3</span><span class="p">,</span> <span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">30</span>
<span class="mi">30</span>  <span class="nb">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">watch</span> <span class="n">c</span>
<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>

<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Old</span> <span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8528</span>
<span class="n">New</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">35</span>
<span class="mi">35</span>      <span class="o">*</span><span class="n">p</span> <span class="o">+=</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>

<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Old</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">New</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">38</span>
<span class="mi">38</span>      <span class="n">a</span> <span class="o">+=</span> <span class="mi">20</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>

<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Old</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">New</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">46</span>
<span class="mi">46</span>      <span class="nb">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>

<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Old</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">New</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">50</span>
<span class="mi">50</span>      <span class="n">b</span> <span class="o">*=</span> <span class="mi">8</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>

<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Old</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">New</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">54</span>
<span class="mi">54</span>      <span class="n">b</span><span class="o">++</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>

<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Old</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">New</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">56</span>
<span class="mi">56</span>      <span class="n">c</span> <span class="o">-=</span> <span class="mi">8</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>

<span class="n">Hardware</span> <span class="n">watchpoint</span> <span class="mi">4</span><span class="p">:</span> <span class="n">c</span>

<span class="n">Old</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">New</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">main</span> <span class="p">()</span> <span class="n">at</span> <span class="n">gdb</span><span class="o">-</span><span class="n">warmup</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">58</span>
<span class="mi">58</span>      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>Practice Question B</strong></p>
<p>The value is <code class="docutils literal notranslate"><span class="pre">42</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(gdb) break gdb-warmup.c:42
Breakpoint 5 at 0x55555555521a: file gdb-warmup.c, line 42.
(gdb) run
Starting program: gdb-warmup

Breakpoint 5, main () at gdb-warmup.c:42
42      *p -= 1;
(gdb) print *p
$1 = 43
(gdb) next
44      c--;
(gdb) print *p
$2 = 42
</pre></div>
</div>
<p><strong>Practice Question C</strong></p>
<p>The value of <code class="docutils literal notranslate"><span class="pre">a</span></code> at line 38 is <code class="docutils literal notranslate"><span class="pre">5</span></code>. After line 41, it is <code class="docutils literal notranslate"><span class="pre">42</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(gdb) break gdb-warmup.c:38
Breakpoint 6 at 0x5555555551fe: file gdb-warmup.c, line 38.
(gdb) run
Starting program: gdb-warmup

Breakpoint 6, main () at gdb-warmup.c:38
38      a += 20;
(gdb) print a
$3 = 5
(gdb) next
39      *p += 3;
(gdb)
40      a *= 2;
(gdb)
41      a = a - c;
(gdb)
42      *p -= 1;
(gdb) print a
$4 = 42
</pre></div>
</div>
<p><strong>Practice Question D</strong></p>
<p>The return value is <code class="docutils literal notranslate"><span class="pre">0xa</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(gdb) break gdb-warmup.c:27
Breakpoint 8 at 0x5555555551bb: file gdb-warmup.c, line 27.
(gdb) run
Starting program: gdb-warmup

Breakpoint 8, num () at gdb-warmup.c:27
27      return num;
(gdb) print/x num
$5 = 0xa
</pre></div>
</div>
<p><strong>Practice Question D</strong></p>
<p>The segfault happens in line 16:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(gdb) run
Starting program: segfault

Program received signal SIGSEGV, Segmentation fault.
0x00005555555551e4 in foo (n=1) at segfault.c:16
16          strcpy(p, &quot;faa&quot;);
(gdb) backtrace
#0  0x00005555555551e4 in foo (n=1) at segfault.c:16
#1  0x00005555555552e8 in main () at segfault.c:63
(gdb) print p
$1 = 0x0
</pre></div>
</div>
<p>It looks like <code class="docutils literal notranslate"><span class="pre">p</span></code> was not initialized! (it is a null pointer) To fix this, we would need to <code class="docutils literal notranslate"><span class="pre">malloc</span></code> memory for <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011-2023, The University of Chicago.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>